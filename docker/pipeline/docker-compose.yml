version: '3.8'

services:
  pipeline:
    build:
      context: ../..
      dockerfile: docker/pipeline/Dockerfile
    container_name: sotd-pipeline
    restart: unless-stopped
    volumes:
      # Mount data directory from Synology shared folder
      - type: bind
        source: /volume1/sotd_data  # Update this to your Synology shared folder path
        target: /data
    environment:
      # Cron schedule (default: hourly at minute 0)
      # Format: minute hour day month weekday
      # Examples:
      #   "0 * * * *" - Every hour at minute 0
      #   "0 */2 * * *" - Every 2 hours
      #   "0 0 * * *" - Daily at midnight
      - CRON_SCHEDULE=${CRON_SCHEDULE:-0 * * * *}
      - SOTD_DATA_DIR=/data
      - LOG_DIR=/data/logs
    # Keep container running (cron runs in foreground)
    command: ["./entrypoint.sh"]
